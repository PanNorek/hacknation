{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///app/src/components/Chat.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useRef, useState } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\n\ninterface Message {\n  role: 'user' | 'assistant';\n  content: string;\n  timestamp: Date;\n}\n\nexport default function Chatbot() {\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  // Function to extract response content if message contains JSON with response field\n  const getDisplayContent = (content: string) => {\n    try {\n      // Check if content looks like JSON\n      if (content.trim().startsWith('{') && content.trim().endsWith('}')) {\n        const parsed = JSON.parse(content);\n        if (parsed && typeof parsed === 'object' && 'response' in parsed) {\n          return parsed.response;\n        }\n      }\n      // If content contains \"response\": try to extract it\n      const responseMatch = content.match(/\"response\"\\s*:\\s*\"([^\"]*)\"/);\n      if (responseMatch) {\n        return responseMatch[1];\n      }\n    } catch (error) {\n      // If parsing fails, return original content\n    }\n    return content;\n  };\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const sendMessage = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!input.trim() || loading) return;\n\n    const userMessage: Message = {\n      role: 'user',\n      content: input.trim(),\n      timestamp: new Date(),\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n    setInput('');\n    setLoading(true);\n\n    try {\n      const response = await fetch('/api/prompt', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ prompt: userMessage.content }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to get response from model');\n      }\n\n      const data = await response.json();\n\n      const assistantMessage: Message = {\n        role: 'assistant',\n        content: data.response || data.message || 'No response received',\n        timestamp: new Date(),\n      };\n\n      setMessages(prev => [...prev, assistantMessage]);\n    } catch (error) {\n      console.error('Chat error:', error);\n      const errorMessage: Message = {\n        role: 'assistant',\n        content: 'Sorry, I encountered an error. Please try again.',\n        timestamp: new Date(),\n      };\n      setMessages(prev => [...prev, errorMessage]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 flex items-center justify-center p-4\">\n      <div className=\"w-[70vw] h-[90vh] bg-white rounded-2xl shadow-xl overflow-hidden flex flex-col\">\n        {/* Header */}\n        <div className=\"bg-blue-600 text-white p-4 flex-shrink-0\">\n          <h1 className=\"text-xl font-semibold\">Scenariusz jutra</h1>\n        </div>\n\n        {/* Messages */}\n        <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n          {messages.length === 0 ? (\n            <div className=\"text-center text-gray-500 mt-8\">\n              <p className=\"text-lg mb-2\">ðŸ‘‹ Welcome to the AI Chatbot!</p>\n              <p>Start a conversation by typing a message below.</p>\n            </div>\n          ) : (\n            messages.map((message, index) => (\n              <div\n                key={index}\n                className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}\n              >\n                <div\n                  className={`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${message.role === 'user'\n                    ? 'bg-blue-600 text-white rounded-br-none'\n                    : 'bg-gray-200 text-gray-800 rounded-bl-none'\n                    }`}\n                >\n                  <div className=\"text-base prose prose-sm max-w-none prose-headings:text-inherit prose-p:text-inherit prose-strong:text-inherit prose-code:text-inherit prose-pre:bg-gray-100 prose-pre:border prose-pre:border-gray-200 prose-ul:text-inherit prose-ol:text-inherit prose-li:text-inherit\">\n                    <ReactMarkdown remarkPlugins={[remarkGfm]}>\n                      {getDisplayContent(message.content)}\n                    </ReactMarkdown>\n                  </div>\n                  <p className={`text-xs mt-1 ${message.role === 'user' ? 'text-blue-100' : 'text-gray-500'\n                    }`}>\n                    {message.timestamp.toLocaleTimeString()}\n                  </p>\n                </div>\n              </div>\n            ))\n          )}\n\n          {loading && (\n            <div className=\"flex justify-start\">\n              <div className=\"bg-gray-200 text-gray-800 rounded-lg rounded-bl-none px-4 py-2\">\n                <div className=\"flex items-center space-x-2\">\n                  <div className=\"flex space-x-1\">\n                    <div className=\"w-2 h-2 bg-gray-500 rounded-full animate-bounce\"></div>\n                    <div className=\"w-2 h-2 bg-gray-500 rounded-full animate-bounce\" style={{ animationDelay: '0.1s' }}></div>\n                    <div className=\"w-2 h-2 bg-gray-500 rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\n                  </div>\n                  <span className=\"text-sm\">AI is thinking...</span>\n                </div>\n              </div>\n            </div>\n          )}\n\n          <div ref={messagesEndRef} />\n        </div>\n\n        {/* Input */}\n        <div className=\"border-t p-4 flex-shrink-0\">\n          <form onSubmit={sendMessage} className=\"flex space-x-2\">\n            <input\n              type=\"text\"\n              value={input}\n              onChange={(e) => setInput(e.target.value)}\n              placeholder=\"Type your message...\"\n              className=\"flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900\"\n              disabled={loading}\n            />\n            <button\n              type=\"submit\"\n              disabled={loading || !input.trim()}\n              className=\"bg-blue-600 text-white px-6 py-2 rounded-full hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n              {loading ? '...' : 'Send'}\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}